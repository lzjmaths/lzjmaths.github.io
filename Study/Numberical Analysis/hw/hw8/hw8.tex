% Sample tex file for usage of iidef.sty
% Homework template for Inference and Information
% UPDATE: October 12, 2017 by Xiangxiang
% UPDATE: 22/03/2018 by zhaofeng-shu33
\documentclass[a4paper]{article}
\usepackage[T1]{fontenc}
\usepackage{amsmath, amssymb, amsthm}
% amsmath: equation*, amssymb: mathbb, amsthm: proof
\usepackage{moreenum}
\usepackage{mathtools}
\usepackage{url}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{booktabs} % toprule
\usepackage[mathcal]{eucal}
\usepackage{dsfont}

\usepackage{setspace}  
\setstretch{1.6}








\theoremstyle{definition}
\newtheorem{definition}{Definition}[section]
\newtheorem{example}[definition]{Example}
\newtheorem{exercise}[definition]{Exercise}
\newtheorem{remark}[definition]{Remark}
\newtheorem{observation}[definition]{Observation}
\newtheorem{assumption}[definition]{Assumption}
\newtheorem{convention}[definition]{Convention}
\newtheorem{priniple}[definition]{Principle}
\newtheorem{notation}[definition]{Notation}
\newtheorem*{axiom}{Axiom}
\newtheorem{coa}[definition]{Theorem}
\newtheorem{srem}[definition]{$\star$ Remark}
\newtheorem{seg}[definition]{$\star$ Example}
\newtheorem{sexe}[definition]{$\star$ Exercise}
\newtheorem{sdf}[definition]{$\star$ Definition}
\newtheorem{question}{Question}




\newtheorem{problem}{Problem}
%\renewcommand*{\theprob}{{\color{red}\arabic{section}.\arabic{prob}}}
\newtheorem{rprob}[problem]{\color{red} Problem}
%\renewcommand*{\thesprob}{{\color{red}\arabic{section}.\arabic{sprob}}}
% \newtheorem{ssprob}[prob]{$\star\star$ Problem}



\theoremstyle{plain}
\newtheorem{theorem}[definition]{Theorem}
\newtheorem{Conclusion}[definition]{Conclusion}
\newtheorem{thd}[definition]{Theorem-Definition}
\newtheorem{proposition}[definition]{Proposition}
\newtheorem{corollary}[definition]{Corollary}
\newtheorem{lemma}[definition]{Lemma}
\newtheorem{sthm}[definition]{$\star$ Theorem}
\newtheorem{slm}[definition]{$\star$ Lemma}
\newtheorem{claim}[definition]{Claim}
\newtheorem{spp}[definition]{$\star$ Proposition}
\newtheorem{scorollary}[definition]{$\star$ Corollary}


\newtheorem{condition}{Condition}
\newtheorem{Mthm}{Main Theorem}
\renewcommand{\thecondition}{\Alph{condition}} % "letter-numbered" theorems
\renewcommand{\theMthm}{\Alph{Mthm}} % "letter-numbered" theorems


%\substack   multiple lines under sum
%\underset{b}{a}   b is under a


% Remind: \overline{L_0}



\usepackage{calligra}
\DeclareMathOperator{\shom}{\mathscr{H}\text{\kern -3pt {\calligra\large om}}\,}
\DeclareMathOperator{\sext}{\mathscr{E}\text{\kern -3pt {\calligra\large xt}}\,}
\DeclareMathOperator{\Rel}{\mathscr{R}\text{\kern -3pt {\calligra\large el}~}\,}
\DeclareMathOperator{\sann}{\mathscr{A}\text{\kern -3pt {\calligra\large nn}}\,}
\DeclareMathOperator{\send}{\mathscr{E}\text{\kern -3pt {\calligra\large nd}}\,}
\DeclareMathOperator{\stor}{\mathscr{T}\text{\kern -3pt {\calligra\large or}}\,}
%write mathscr Hom (and so on) 

\usepackage{aurical}
\DeclareMathOperator{\VVir}{\text{\Fontlukas V}\text{\kern -0pt {\Fontlukas\large ir}}\,}

\newcommand{\vol}{\text{\Fontlukas V}}
\newcommand{\dvol}{d~\text{\Fontlukas V}}
% perfect Vol symbol

\usepackage{aurical}








\newcommand{\fk}{\mathfrak}
\newcommand{\mc}{\mathcal}
\newcommand{\wtd}{\widetilde}
\newcommand{\wht}{\widehat}
\newcommand{\wch}{\widecheck}
\newcommand{\ovl}{\overline}
\newcommand{\udl}{\underline}
\newcommand{\tr}{\mathrm{t}} %transpose
\newcommand{\Tr}{\mathrm{Tr}}
\newcommand{\End}{\mathrm{End}} %endomorphism
\newcommand{\idt}{\mathbf{1}}
\newcommand{\id}{\mathrm{id}}
\newcommand{\Hom}{\mathrm{Hom}}
\newcommand{\cond}[1]{\mathrm{cond}_{#1}}
\newcommand{\Conf}{\mathrm{Conf}}
\newcommand{\Res}{\mathrm{Res}}
\newcommand{\res}{\mathrm{res}}
\newcommand{\KZ}{\mathrm{KZ}}
\newcommand{\ev}{\mathrm{ev}}
\newcommand{\coev}{\mathrm{coev}}
\newcommand{\opp}{\mathrm{opp}}
\newcommand{\Rep}{\mathrm{Rep}}
\newcommand{\Dom}{\mathrm{Dom}}
\newcommand{\loc}{\mathrm{loc}}
\newcommand{\con}{\mathrm{c}}
\newcommand{\uni}{\mathrm{u}}
\newcommand{\ssp}{\mathrm{ss}}
\newcommand{\di}{\slashed d}
\newcommand{\Diffp}{\mathrm{Diff}^+}
\newcommand{\Diff}{\mathrm{Diff}}
\newcommand{\PSU}{\mathrm{PSU}(1,1)}
\newcommand{\Vir}{\mathrm{Vir}}
\newcommand{\Witt}{\mathscr W}
\newcommand{\Span}{\mathrm{Span}}
\newcommand{\pri}{\mathrm{p}}
\newcommand{\ER}{E^1(V)_{\mathbb R}}
\newcommand{\prth}[1]{( {#1})}
\newcommand{\bk}[1]{\langle {#1}\rangle}
\newcommand{\bigbk}[1]{\big\langle {#1}\big\rangle}
\newcommand{\Bigbk}[1]{\Big\langle {#1}\Big\rangle}
\newcommand{\biggbk}[1]{\bigg\langle {#1}\bigg\rangle}
\newcommand{\Biggbk}[1]{\Bigg\langle {#1}\Bigg\rangle}
\newcommand{\GA}{\mathscr G_{\mathcal A}}
\newcommand{\vs}{\varsigma}
\newcommand{\Vect}{\mathrm{Vec}}
\newcommand{\Vectc}{\mathrm{Vec}^{\mathbb C}}
\newcommand{\scr}{\mathscr}
\newcommand{\sjs}{\subset\joinrel\subset}
\newcommand{\Jtd}{\widetilde{\mathcal J}}
\newcommand{\gk}{\mathfrak g}
\newcommand{\hk}{\mathfrak h}
\newcommand{\xk}{\mathfrak x}
\newcommand{\yk}{\mathfrak y}
\newcommand{\zk}{\mathfrak z}
\newcommand{\pk}{\mathfrak p}
\newcommand{\hr}{\mathfrak h_{\mathbb R}}
\newcommand{\Ad}{\mathrm{Ad}}
\newcommand{\DHR}{\mathrm{DHR}_{I_0}}
\newcommand{\Repi}{\mathrm{Rep}_{\wtd I_0}}
\newcommand{\im}{\mathbf{i}}
\newcommand{\Co}{\complement}
%\newcommand{\Cu}{\mathcal C^{\mathrm u}}
\newcommand{\RepV}{\mathrm{Rep}^\uni(V)}
\newcommand{\RepA}{\mathrm{Rep}(\mathcal A)}
\newcommand{\RepN}{\mathrm{Rep}(\mathcal N)}
\newcommand{\RepfA}{\mathrm{Rep}^{\mathrm f}(\mathcal A)}
\newcommand{\RepAU}{\mathrm{Rep}^\uni(A_U)}
\newcommand{\RepU}{\mathrm{Rep}^\uni(U)}
\newcommand{\RepL}{\mathrm{Rep}^{\mathrm{L}}}
\newcommand{\HomL}{\mathrm{Hom}^{\mathrm{L}}}
\newcommand{\EndL}{\mathrm{End}^{\mathrm{L}}}
\newcommand{\Bim}{\mathrm{Bim}}
\newcommand{\BimA}{\mathrm{Bim}^\uni(A)}
%\newcommand{\shom}{\scr Hom}
\newcommand{\divi}{\mathrm{div}}
\newcommand{\sgm}{\varsigma}
\newcommand{\SX}{{S_{\fk X}}}
\newcommand{\DX}{D_{\fk X}}
\newcommand{\mbb}{\mathbb}
\newcommand{\mbf}{\mathbf}
\newcommand{\bsb}{\boldsymbol}
\newcommand{\blt}{\bullet}
\newcommand{\Vbb}{\mathbb V}
\newcommand{\Ubb}{\mathbb U}
\newcommand{\Xbb}{\mathbb X}
\newcommand{\Kbb}{\mathbb K}
\newcommand{\Abb}{\mathbb A}
\newcommand{\Wbb}{\mathbb W}
\newcommand{\Mbb}{\mathbb M}
\newcommand{\Gbb}{\mathbb G}
\newcommand{\Cbb}{\mathbb C}
\newcommand{\Nbb}{\mathbb N}
\newcommand{\Zbb}{\mathbb Z}
\newcommand{\Qbb}{\mathbb Q}
\newcommand{\Pbb}{\mathbb P}
\newcommand{\Rbb}{\mathbb R}
\newcommand{\Ebb}{\mathbb E}
\newcommand{\Dbb}{\mathbb D}
\newcommand{\Hbb}{\mathbb H}
\newcommand{\cbf}{\mathbf c}
\newcommand{\Rbf}{\mathbf R}
\newcommand{\wt}{\mathrm{wt}}
\newcommand{\Lie}{\mathrm{Lie}}
\newcommand{\btl}{\blacktriangleleft}
\newcommand{\btr}{\blacktriangleright}
\newcommand{\svir}{\mathcal V\!\mathit{ir}}
\newcommand{\Ker}{\mathrm{Ker}}
\newcommand{\Cok}{\mathrm{Coker}}
\newcommand{\Sbf}{\mathbf{S}}
\newcommand{\low}{\mathrm{low}}
\newcommand{\Sp}{\mathrm{Sp}}
\newcommand{\Rng}{\mathrm{Rng}}
\newcommand{\vN}{\mathrm{vN}}
\newcommand{\Ebf}{\mathbf E}
\newcommand{\Nbf}{\mathbf N}
\newcommand{\Stb}{\mathrm {Stb}}
\newcommand{\SXb}{{S_{\fk X_b}}}
\newcommand{\pr}{\mathrm {pr}}
\newcommand{\SXtd}{S_{\wtd{\fk X}}}
\newcommand{\univ}{\mathrm {univ}}
\newcommand{\vbf}{\mathbf v}
\newcommand{\ubf}{\mathbf u}
\newcommand{\wbf}{\mathbf w}
\newcommand{\CB}{\mathrm{CB}}
\newcommand{\Perm}{\mathrm{Perm}}
\newcommand{\Orb}{\mathrm{Orb}}
\newcommand{\Lss}{{L_{0,\mathrm{s}}}}
\newcommand{\Lni}{{L_{0,\mathrm{n}}}}
\newcommand{\UPSU}{\widetilde{\mathrm{PSU}}(1,1)}
\newcommand{\Sbb}{{\mathbb S}}
\newcommand{\Gc}{\mathscr G_c}
\newcommand{\Obj}{\mathrm{Obj}}
\newcommand{\bpr}{{}^\backprime}
\newcommand{\fin}{\mathrm{fin}}
\newcommand{\Ann}{\mathrm{Ann}}
\newcommand{\Real}{\mathrm{Re}}
\newcommand{\Imag}{\mathrm{Im}}
%\newcommand{\cl}{\mathrm{cl}}
\newcommand{\Ind}{\mathrm{Ind}}
\newcommand{\Supp}{\mathrm{Supp}}
\newcommand{\Specan}{\mathrm{Specan}}
\newcommand{\red}{\mathrm{red}}
\newcommand{\uph}{\upharpoonright}
\newcommand{\Mor}{\mathrm{Mor}}
\newcommand{\pre}{\mathrm{pre}}
\newcommand{\rank}{\mathrm{rank}}
\newcommand{\Jac}{\mathrm{Jac}}
\newcommand{\emb}{\mathrm{emb}}
\newcommand{\Sg}{\mathrm{Sg}}
\newcommand{\Nzd}{\mathrm{Nzd}}
\newcommand{\Owht}{\widehat{\scr O}}
\newcommand{\Ext}{\mathrm{Ext}}
\newcommand{\Tor}{\mathrm{Tor}}
\newcommand{\Com}{\mathrm{Com}}
\newcommand{\Mod}{\mathrm{Mod}}
\newcommand{\nk}{\mathfrak n}
\newcommand{\mk}{\mathfrak m}
\newcommand{\Ass}{\mathrm{Ass}}
\newcommand{\depth}{\mathrm{depth}}
\newcommand{\Coh}{\mathrm{Coh}}
\newcommand{\Gode}{\mathrm{Gode}}
\newcommand{\Fbb}{\mathbb F}
\newcommand{\sgn}{\mathrm{sgn}}
\newcommand{\Aut}{\mathrm{Aut}}
\newcommand{\Modf}{\mathrm{Mod}^{\mathrm f}}
\newcommand{\codim}{\mathrm{codim}}
\newcommand{\card}{\mathrm{card}}
\newcommand{\dps}{\displaystyle}
\newcommand{\Int}{\mathrm{Int}}
\newcommand{\Nbh}{\mathrm{Nbh}}
\newcommand{\Pnbh}{\mathrm{PNbh}}
\newcommand{\Cl}{\mathrm{Cl}}
\newcommand{\diam}{\mathrm{diam}}
\newcommand{\eps}{\varepsilon}
\newcommand{\Vol}{\mathrm{Vol}}
\newcommand{\LSC}{\mathrm{LSC}}
\newcommand{\USC}{\mathrm{USC}}
\newcommand{\Ess}{\mathrm{Rng}^{\mathrm{ess}}}
\newcommand{\Jbf}{\mathbf{J}}
\newcommand{\SL}{\mathrm{SL}}
\newcommand{\GL}{\mathrm{GL}}
\newcommand{\Lin}{\mathrm{Lin}}
\newcommand{\ALin}{\mathrm{ALin}}
\newcommand{\bwn}{\bigwedge\nolimits}
\newcommand{\nbf}{\mathbf n}
\newcommand{\dive}{\mathrm{div}}




\usepackage{algorithm}
\usepackage{algorithmic}

\newcommand{\<}{\left<}
\renewcommand{\>}{\right>}


\numberwithin{equation}{problem}
% count the eqation by section countation


\DeclareMathOperator{\sign}{sign}
\DeclareMathOperator{\dom}{dom}
\DeclareMathOperator{\ran}{ran}
\DeclareMathOperator{\ord}{ord}
\DeclareMathOperator{\img}{Im}
\DeclareMathOperator{\dd}{d\!}
\newcommand{\ie}{ \textit{ i.e. } }
\newcommand{\st}{ \textit{ s.t. }}


\usepackage[numbered,framed]{matlab-prettifier}
\lstset{
  style              = Matlab-editor,
  captionpos         =b,
  basicstyle         = \mlttfamily,
  escapechar         = ",
  mlshowsectionrules = true,
}
\usepackage{ctex}

\usepackage[thehwcnt = 7]{iidef}
\thecourseinstitute{Tsinghua University}
\thecoursename{Numerical Analysis}
\theterm{Fall 2024}
\hwname{Homework}
\usepackage{geometry}
\geometry{left=1.5cm,right=1.5cm,top=2.5cm,bottom=2.5cm}
\begin{document}
\courseheader
\name{Lin Zejin}

\vspace{2em}

\sloppy
\pagenumbering{arabic}
\begin{problem}
    \[\begin{aligned}
        y(x+h)-y(x)-hf(x+h,y+hf(x,y))&=hy'(x)+\frac{1}{2}h^2y''(x)-h(f(x,y)+h\frac{\partial f}{\partial x}+hf(x,y)\frac{\partial f}{\partial y})+O(h^3)\\
        &=\frac{h^2}{2}y''(x)-h^2y''(x)+O(h^3)\\
        &=-\frac{h^2}{2}y''(x)+O(h^3)
    \end{aligned}\]
\end{problem}
\begin{problem}
    \[k_1=\frac{\dd y}{\dd x}\]
    \begin{align*}
        k_2&=f(x+c_2 h,y+ha_{21} k_1)\\
        &=f(x,y)+hc_2\frac{\partial f}{\partial x}+k_1ha_{21}\frac{\partial f}{\partial y}+\left(c_2^2h^2\frac{\partial^2 f}{\partial x^2}+a_{21}^2k_1^2h^2\frac{\partial^2 f}{\partial y^2}+2c_2a_{21}h^2\frac{\partial^2 f}{\partial x\partial y}\right)+O(h^3)
    \end{align*}
    \begin{align*}
        k_3&=f(x+c_3h,y+ha_{31}k_1+ha_{32}k_2)\\
        &=f(x+c_3h,y+ha_{31}k_1)+ha_{32}k_2\frac{\partial f}{\partial y}+\frac{h^2a_{32}^2k_2^2}{2}\frac{\partial ^2 f}{\partial y^2}+O(h^3)\\
        &=f(x,y)+hc_3\frac{\partial f}{\partial x}+k_1ha_{32}\frac{\partial f}{\partial y}+\left(c_3^2h^2\frac{\partial^2 f}{\partial x^2}+a_{32}^2k_1^2h^2\frac{\partial^2 f}{\partial y^2}+2c_3a_{32}h^2\frac{\partial^2 f}{\partial x\partial y}\right)\\
        &+ha_{32}k_2\frac{\partial f}{\partial y}+\frac{h^2a_{32}^2k_2^2}{2}\frac{\partial ^2 f}{\partial y^2}+O(h^3)
    \end{align*}

    where  $ \tilde{k}_2=k_2/h $ 


    Noticed that 
    \[y'''(x)=\left(\frac{\partial f}{\partial x}+y'(x)\frac{\partial f}{\partial y}\right)'=\frac{\partial ^2 f}{\partial x^2}+2y'\frac{\partial ^2 f}{\partial x\partial y}+(y')^2\frac{\partial ^2 f}{\partial y^2}+y''\frac{\partial f}{\partial y}\]

    Then compared each term,  $ b_1k_1+b_2k_2+b_3k_3=y'+\frac{1}{2}hy''+\frac{1}{6}h^2y'''+O(h^3) $ if
    \[
        \begin{aligned}
            b_1+b_2+b_3&=1\\
            b_2c_2+b_3c_3&=\frac{1}{2}\\
            b_2c_2^2+b_3c_3^2&=\frac{1}{3}\\
            b_3c_2a_{32}&=\frac{1}{6}
        \end{aligned}
    \]
\end{problem}

\begin{problem}
    \[\begin{aligned}
        T_{n+3}&=y(x_{n+3})+\alpha(y(x_{n+2})-y(x_{n+1}))-y(x_n)-\frac{1}{2}(3+\alpha)h[f(x_{n+2},y(x_{n+2}))+f(x_{n+1},y(x_{n+1}))]\\
        &=\left[3hy'(x_{n+1})+\frac{3}{2}h^2y^{(2)}(x_{n+1})+\frac{3}{2}h^3y^{(3)}(x_{n+1})+\frac{15}{24}y^{(4)}(X_{n+1})\right]\\
        &+\alpha\left[hy'(x_{n+1})+\frac{1}{2}h^2y^{(2)}(x_{n+1})+\frac{1}{6}h^3y^{(3)}(x_{n+1})+\frac{1}{24}y^{(4)}(X_{n+1})\right]\\
        &-\frac{3+\alpha}{h}\left[2y'(x_{n+1})+hy^{(2)}(X_{n+1})+\frac{h^2}{2}y^{(3)}(x_{n+1})+\frac{h^3}{6}y^{(4)}(x_{n+1})\right]+O(h^5)\\
        &=\frac{9-\alpha}{12}h^3y^{(3)}(x_{n+1})+\frac{9-\alpha}{24}h^4y^{(4)}(x_{n+1})+O(h^5)
    \end{aligned}\]
    So take  $ \alpha=9 $ it is a convergent method of order  $ 4 $.
    
\end{problem}
\begin{problem}
    考虑常微分方程 
\[
y' = f(x,y), \quad x \in [x_n,\,x_{n+1}], \quad h = x_{n+1} - x_n.
\]
为了导出四步显式 Adams–Bashforth 方法，我们在区间 $[x_n,\,x_{n+1}]$ 上引入配点
\[
x = x_n + s\,h,\qquad s \in [0,1].
\]
令
\[
F(s) \;=\; f\bigl(x_n + s\,h,\;y(x_n + s\,h)\bigr).
\]
我们希望用 $F(s)$ 在 $s = 0,\,-1,\,-2,\,-3$ 处的值来做三次 Lagrange 插值，然后对插值多项式在 $s\in[0,1]$ 上积分，得到
\[
\int_{0}^{1} F(s)\,ds
\;\approx\;
\sum_{j=0}^{3} b_j\,F(-\,j),
\]
从而公式
\[
y_{n+1} \;=\; y_n \;+\; h \int_{0}^{1} F(s)\,ds
\;\approx\;
y_n \;+\; h \sum_{j=0}^{3} b_j\,f\bigl(x_{n-j},\,y_{n-j}\bigr).
\]
下面计算各系数 $b_j = \displaystyle\int_{0}^{1} \ell_j(s)\,ds$，其中 $\{\ell_j(s)\}$ 是通过配点 $s=0,-1,-2,-3$ 构造的 Lagrange 基函数。

\medskip

\noindent\textbf{(1) 构造插值节点与基函数}  

配点为
\[
s_0 = 0,\quad s_1 = -1,\quad s_2 = -2,\quad s_3 = -3.
\]
对应的 Lagrange 基函数 $\ell_j(s)$ 满足 $\ell_j(s_i) = \delta_{ij}$。具体地：
\[
\ell_0(s)
= \frac{(s - s_1)(s - s_2)(s - s_3)}{(s_0 - s_1)(s_0 - s_2)(s_0 - s_3)}
= \frac{(s + 1)(s + 2)(s + 3)}{(0 + 1)(0 + 2)(0 + 3)}
= \frac{(s + 1)(s + 2)(s + 3)}{6},
\]
\[
\ell_1(s)
= \frac{(s - s_0)(s - s_2)(s - s_3)}{(s_1 - s_0)(s_1 - s_2)(s_1 - s_3)}
= \frac{s\,(s + 2)(s + 3)}{(-1 - 0)\,(-1 + 2)\,(-1 + 3)}
= \frac{s\,(s + 2)(s + 3)}{(-1)\,(1)\,(2)}
= -\,\frac{s\,(s + 2)(s + 3)}{2},
\]
\[
\ell_2(s)
= \frac{(s - s_0)(s - s_1)(s - s_3)}{(s_2 - s_0)(s_2 - s_1)(s_2 - s_3)}
= \frac{s\,(s + 1)\,(s + 3)}{(-2 - 0)\,(-2 + 1)\,(-2 + 3)}
= \frac{s\,(s + 1)\,(s + 3)}{(-2)\,(-1)\,(1)}
= \frac{s\,(s + 1)\,(s + 3)}{2},
\]
\[
\ell_3(s)
= \frac{(s - s_0)(s - s_1)(s - s_2)}{(s_3 - s_0)(s_3 - s_1)(s_3 - s_2)}
= \frac{s\,(s + 1)\,(s + 2)}{(-3 - 0)\,(-3 + 1)\,(-3 + 2)}
= \frac{s\,(s + 1)\,(s + 2)}{(-3)\,(-2)\,(-1)}
= -\,\frac{s\,(s + 1)\,(s + 2)}{6}.
\]

\medskip

\noindent\textbf{(2) 计算各基函数在 $[0,1]$ 上的面积}  

\begin{itemize}
  \item \textbf{系数 $b_0 = \displaystyle\int_{0}^{1} \ell_0(s)\,ds$.}  
    \[
    \ell_0(s) = \frac{(s + 1)(s + 2)(s + 3)}{6}
    = \frac{1}{6}\bigl(s^3 + 6\,s^2 + 11\,s + 6\bigr).
    \]
    因此
    \[
    b_0 
    = \int_{0}^{1} \ell_0(s)\,ds
    = \frac{1}{6} \int_{0}^{1} \bigl(s^3 + 6\,s^2 + 11\,s + 6\bigr)\,ds
    = \frac{1}{6} \Bigl[
       \frac{s^4}{4} + 6\,\frac{s^3}{3} + 11\,\frac{s^2}{2} + 6\,s
    \Bigr]_{0}^{1}.
    \]
    计算括号内：
    \[
    \left.\frac{s^4}{4}\right|_{0}^{1} = \frac{1}{4},\quad
    \left.6\,\frac{s^3}{3}\right|_{0}^{1} = 2,\quad
    \left.11\,\frac{s^2}{2}\right|_{0}^{1} = \frac{11}{2},\quad
    \left.6\,s\right|_{0}^{1} = 6.
    \]
    所以
    \[
    b_0 
    = \frac{1}{6} \Bigl( \frac{1}{4} + 2 + \frac{11}{2} + 6 \Bigr)
    = \frac{1}{6} \Bigl( \frac{1 + 8 + 22 + 24}{4} \Bigr)
    = \frac{1}{6} \cdot \frac{55}{4}
    = \frac{55}{24}.
    \]
  
  \item \textbf{系数 $b_1 = \displaystyle\int_{0}^{1} \ell_1(s)\,ds$.}  
    \[
    \ell_1(s) \;=\; -\,\frac{s\,\bigl(s + 2\bigr)\,\bigl(s + 3\bigr)}{2}
    = -\,\frac{1}{2}\bigl(s^3 + 5\,s^2 + 6\,s\bigr).
    \]
    因此
    \[
    b_1 
    = \int_{0}^{1} \ell_1(s)\,ds
    = -\,\frac{1}{2} \int_{0}^{1} \bigl(s^3 + 5\,s^2 + 6\,s\bigr)\,ds
    = -\,\frac{1}{2} \Bigl[
      \frac{s^4}{4} + 5\,\frac{s^3}{3} + 6\,\frac{s^2}{2}
    \Bigr]_{0}^{1}.
    \]
    计算括号内：
    \[
    \left.\frac{s^4}{4}\right|_{0}^{1} = \frac{1}{4},\quad
    \left.5\,\frac{s^3}{3}\right|_{0}^{1} = \frac{5}{3},\quad
    \left.6\,\frac{s^2}{2}\right|_{0}^{1} = 3.
    \]
    因此
    \[
    \int_{0}^{1} \bigl(s^3 + 5\,s^2 + 6\,s\bigr)\,ds 
    = \frac{1}{4} + \frac{5}{3} + 3 
    = \frac{3}{12} + \frac{20}{12} + \frac{36}{12} 
    = \frac{59}{12}.
    \]
    于是
    \[
    b_1 = -\,\frac{1}{2} \cdot \frac{59}{12} 
    = -\,\frac{59}{24}.
    \]

  \item \textbf{系数 $b_2 = \displaystyle\int_{0}^{1} \ell_2(s)\,ds$.}  
    \[
    \ell_2(s) 
    = \frac{s\,(s + 1)\,(s + 3)}{2} 
    = \frac{1}{2}\bigl(s^3 + 4\,s^2 + 3\,s\bigr).
    \]
    因此
    \[
    b_2 
    = \int_{0}^{1} \ell_2(s)\,ds
    = \frac{1}{2} \int_{0}^{1} \bigl(s^3 + 4\,s^2 + 3\,s\bigr)\,ds
    = \frac{1}{2} \Bigl[
      \frac{s^4}{4} + 4\,\frac{s^3}{3} + 3\,\frac{s^2}{2}
    \Bigr]_{0}^{1}.
    \]
    计算括号内：
    \[
    \left.\frac{s^4}{4}\right|_{0}^{1} = \frac{1}{4},\quad
    \left.4\,\frac{s^3}{3}\right|_{0}^{1} = \frac{4}{3},\quad
    \left.3\,\frac{s^2}{2}\right|_{0}^{1} = \frac{3}{2}.
    \]
    因此
    \[
    \int_{0}^{1} \bigl(s^3 + 4\,s^2 + 3\,s\bigr)\,ds 
    = \frac{1}{4} + \frac{4}{3} + \frac{3}{2} 
    = \frac{3}{12} + \frac{16}{12} + \frac{18}{12} 
    = \frac{37}{12}.
    \]
    于是
    \[
    b_2 = \frac{1}{2} \cdot \frac{37}{12} 
    = \frac{37}{24}.
    \]

  \item \textbf{系数 $b_3 = \displaystyle\int_{0}^{1} \ell_3(s)\,ds$.}  
    \[
    \ell_3(s) 
    = -\,\frac{s\,(s + 1)\,(s + 2)}{6} 
    = -\,\frac{1}{6}\bigl(s^3 + 3\,s^2 + 2\,s\bigr).
    \]
    因此
    \[
    b_3 
    = \int_{0}^{1} \ell_3(s)\,ds
    = -\,\frac{1}{6} \int_{0}^{1} \bigl(s^3 + 3\,s^2 + 2\,s\bigr)\,ds
    = -\,\frac{1}{6} \Bigl[
      \frac{s^4}{4} + 3\,\frac{s^3}{3} + 2\,\frac{s^2}{2}
    \Bigr]_{0}^{1}.
    \]
    计算括号内：
    \[
    \left.\frac{s^4}{4}\right|_{0}^{1} = \frac{1}{4},\quad
    \left.3\,\frac{s^3}{3}\right|_{0}^{1} = 1,\quad
    \left.2\,\frac{s^2}{2}\right|_{0}^{1} = 1.
    \]
    因此
    \[
    \int_{0}^{1} \bigl(s^3 + 3\,s^2 + 2\,s\bigr)\,ds 
    = \frac{1}{4} + 1 + 1 
    = \frac{1 + 4 + 4}{4} 
    = \frac{9}{4}.
    \]
    于是
    \[
    b_3 = -\,\frac{1}{6} \cdot \frac{9}{4} 
    = -\,\frac{9}{24}.
    \]
\end{itemize}

综上可得四步显式 Adams–Bashforth 方法（AB4）为
\[
\boxed{
y_{n+1} \;=\; y_n 
\;+\; h \Bigl(
   \frac{55}{24}\,f(x_n,y_n)
 - \frac{59}{24}\,f(x_{n-1},y_{n-1})
 + \frac{37}{24}\,f(x_{n-2},y_{n-2})
 - \frac{9}{24}\,f(x_{n-3},y_{n-3})
\Bigr).
}
\]

\bigskip
\section*{三步隐式 Adams–Moulton 方法 (AM3) 系数推导}

考虑隐式 Adams–Moulton 的三步（k=3）情形，公式形式为
\[
y_{n+1} \;=\; y_n \;+\; h \sum_{j=-1}^{2} a_j \, f\bigl(x_{n-j},\,y_{n-j}\bigr),
\]
其中 $a_{-1}$ 对应 $f(x_{n+1},y_{n+1})$（隐式项），其余 $a_0,a_1,a_2$ 对应前面三个点 $x_n,x_{n-1},x_{n-2}$。  

同样在区间 $[x_n,\;x_{n+1}]$ 上引入参数
\[
x = x_n + s\,h,\qquad s \in [0,1],
\qquad 
G(s) \;=\; f\bigl(x_n + s\,h,\;y(x_n + s\,h)\bigr).
\]
我们用 $G(s)$ 在 $s = 1,\,0,\,-1,\,-2$ 处的值做三次 Lagrange 插值，然后对插值多项式在 $s\in[0,1]$ 上积分：
\[
\int_{0}^{1} G(s)\,ds
\;\approx\;
\sum_{j = -1}^{2} a_j \, G\bigl(s_j\bigr),
\]
其中配点为
\[
s_{-1} = 1,\quad s_0 = 0,\quad s_1 = -1,\quad s_2 = -2.
\]
于是
\[
y_{n+1} 
= y_n 
+ h \int_{0}^{1} G(s)\,ds
\approx
y_n 
+ h \Bigl(
  a_{-1} f(x_{n+1},y_{n+1})
+ a_{0} f(x_{n},y_{n})
+ a_{1} f(x_{n-1},y_{n-1})
+ a_{2} f(x_{n-2},y_{n-2})
\Bigr).
\]
下面利用 Lagrange 基函数计算 $a_{-1},\,a_0,\,a_1,\,a_2$。

\medskip

\noindent\textbf{(1) 构造插值节点与基函数}  

配点：
\[
s_{-1} = 1,\quad s_{0} = 0,\quad s_{1} = -1,\quad s_{2} = -2.
\]
对应的 Lagrange 基函数 $\ell_j(s)$（为了标号方便，令下标与 $s_j$ 同名）满足 $\ell_j(s_i) = \delta_{ij}$。  

\begin{itemize}
  \item 当 $j = -1$（节点 $s = 1$）时，
    \[
    \ell_{-1}(s)
    = \frac{(s - s_0)(s - s_1)(s - s_2)}
           {(s_{-1} - s_0)(s_{-1} - s_1)(s_{-1} - s_2)}
    = \frac{(s - 0)\,(s + 1)\,(s + 2)}
           {(1 - 0)\,(1 + 1)\,(1 + 2)}
    = \frac{s\,(s + 1)\,(s + 2)}{1 \cdot 2 \cdot 3}
    = \frac{s\,(s + 1)\,(s + 2)}{6}.
    \]
  
  \item 当 $j = 0$（节点 $s = 0$）时，
    \[
    \ell_{0}(s)
    = \frac{(s - s_{-1})(s - s_{1})(s - s_{2})}
           {(s_{0} - s_{-1})(s_{0} - s_{1})(s_{0} - s_{2})}
    = \frac{(s - 1)\,(s + 1)\,(s + 2)}
           {(0 - 1)\,(0 + 1)\,(0 + 2)}
    = \frac{(s - 1)\,(s + 1)\,(s + 2)}{(-1)\,(1)\,(2)}
    = -\,\frac{(s - 1)\,(s + 1)\,(s + 2)}{2}.
    \]
  
  \item 当 $j = 1$（节点 $s = -1$）时，
    \[
    \ell_{1}(s)
    = \frac{(s - s_{-1})(s - s_{0})(s - s_{2})}
           {(s_{1} - s_{-1})(s_{1} - s_{0})(s_{1} - s_{2})}
    = \frac{(s - 1)\,(s - 0)\,(s + 2)}
           {(-1 - 1)\,(-1 - 0)\,(-1 + 2)}
    = \frac{(s - 1)\,s\,(s + 2)}{(-2)\,(-1)\,(1)}
    = \frac{(s - 1)\,s\,(s + 2)}{2}.
    \]
  
  \item 当 $j = 2$（节点 $s = -2$）时，
    \[
    \ell_{2}(s)
    = \frac{(s - s_{-1})(s - s_{0})(s - s_{1})}
           {(s_{2} - s_{-1})(s_{2} - s_{0})(s_{2} - s_{1})}
    = \frac{(s - 1)\,(s - 0)\,(s + 1)}
           {(-2 - 1)\,(-2 - 0)\,(-2 + 1)}
    = \frac{(s - 1)\,s\,(s + 1)}{(-3)\,(-2)\,(-1)}
    = -\,\frac{(s - 1)\,s\,(s + 1)}{6}.
    \]
\end{itemize}

\medskip

\noindent\textbf{(2) 计算各基函数在 $[0,1]$ 上的面积}  

\begin{itemize}
  \item \textbf{系数 $a_{-1} = \displaystyle\int_{0}^{1} \ell_{-1}(s)\,ds$.}  
    \[
    \ell_{-1}(s)
    = \frac{s\,(s + 1)\,(s + 2)}{6}
    = \frac{1}{6}\bigl(s^3 + 3\,s^2 + 2\,s\bigr).
    \]
    因此
    \[
    a_{-1}
    = \int_{0}^{1} \ell_{-1}(s)\,ds
    = \frac{1}{6} \int_{0}^{1} \bigl(s^3 + 3\,s^2 + 2\,s\bigr)\,ds
    = \frac{1}{6} \Bigl[
      \frac{s^4}{4} + 3\,\frac{s^3}{3} + 2\,\frac{s^2}{2}
    \Bigr]_{0}^{1}.
    \]
    计算括号内：
    \[
    \left.\frac{s^4}{4}\right|_{0}^{1} = \frac{1}{4},\quad
    \left.3\,\frac{s^3}{3}\right|_{0}^{1} = 1,\quad
    \left.2\,\frac{s^2}{2}\right|_{0}^{1} = 1.
    \]
    所以
    \[
    \int_{0}^{1} \bigl(s^3 + 3\,s^2 + 2\,s\bigr)\,ds 
    = \frac{1}{4} + 1 + 1 
    = \frac{9}{4},
    \quad
    a_{-1} = \frac{1}{6} \cdot \frac{9}{4} = \frac{9}{24}.
    \]
  
  \item \textbf{系数 $a_{0} = \displaystyle\int_{0}^{1} \ell_{0}(s)\,ds$.}  
    \[
    \ell_{0}(s)
    = -\,\frac{(s - 1)\,(s + 1)\,(s + 2)}{2}
    = -\,\frac{1}{2}\bigl(s^3 + 2\,s^2 - s - 2\bigr).
    \]
    因此
    \[
    a_{0}
    = \int_{0}^{1} \ell_{0}(s)\,ds
    = -\,\frac{1}{2} \int_{0}^{1} \bigl(s^3 + 2\,s^2 - s - 2\bigr)\,ds
    = -\,\frac{1}{2} \Bigl[
      \frac{s^4}{4} + 2\,\frac{s^3}{3} - \frac{s^2}{2} - 2\,s
    \Bigr]_{0}^{1}.
    \]
    计算括号内：
    \[
    \left.\frac{s^4}{4}\right|_{0}^{1} = \frac{1}{4},\quad
    \left.2\,\frac{s^3}{3}\right|_{0}^{1} = \frac{2}{3},\quad
    \left.-\,\frac{s^2}{2}\right|_{0}^{1} = -\,\frac{1}{2},\quad
    \left.-\,2\,s\right|_{0}^{1} = -\,2.
    \]
    所以
    \[
    \int_{0}^{1} \bigl(s^3 + 2\,s^2 - s - 2\bigr)\,ds
    = \frac{1}{4} + \frac{2}{3} - \frac{1}{2} - 2
    = \frac{3}{12} + \frac{8}{12} - \frac{6}{12} - \frac{24}{12}
    = -\,\frac{19}{12},
    \]
    \[
    a_{0} = -\,\frac{1}{2} \cdot \Bigl(-\,\frac{19}{12}\Bigr)
    = \frac{19}{24}.
    \]
  
  \item \textbf{系数 $a_{1} = \displaystyle\int_{0}^{1} \ell_{1}(s)\,ds$.}  
    \[
    \ell_{1}(s)
    = \frac{(s - 1)\,s\,(s + 2)}{2}
    = \frac{1}{2}\bigl(s^3 + s^2 - 2\,s\bigr).
    \]
    因此
    \[
    a_{1} 
    = \int_{0}^{1} \ell_{1}(s)\,ds
    = \frac{1}{2} \int_{0}^{1} \bigl(s^3 + s^2 - 2\,s\bigr)\,ds
    = \frac{1}{2} \Bigl[
      \frac{s^4}{4} + \frac{s^3}{3} - s^2
    \Bigr]_{0}^{1}.
    \]
    计算括号内：
    \[
    \left.\frac{s^4}{4}\right|_{0}^{1} = \frac{1}{4},\quad
    \left.\frac{s^3}{3}\right|_{0}^{1} = \frac{1}{3},\quad
    \left.-\,s^2\right|_{0}^{1} = -1.
    \]
    所以
    \[
    \int_{0}^{1} \bigl(s^3 + s^2 - 2\,s\bigr)\,ds
    = \frac{1}{4} + \frac{1}{3} - 1
    = \frac{3}{12} + \frac{4}{12} - \frac{12}{12}
    = -\,\frac{5}{12},
    \]
    \[
    a_{1} = \frac{1}{2} \cdot \Bigl(-\,\frac{5}{12}\Bigr)
    = -\,\frac{5}{24}.
    \]
  
  \item \textbf{系数 $a_{2} = \displaystyle\int_{0}^{1} \ell_{2}(s)\,ds$.}  
    \[
    \ell_{2}(s)
    = -\,\frac{(s - 1)\,s\,(s + 1)}{6}
    = -\,\frac{1}{6}\bigl(s^3 - s\bigr).
    \]
    因此
    \[
    a_{2} 
    = \int_{0}^{1} \ell_{2}(s)\,ds
    = -\,\frac{1}{6} \int_{0}^{1} \bigl(s^3 - s\bigr)\,ds
    = -\,\frac{1}{6} \Bigl[
      \frac{s^4}{4} - \frac{s^2}{2}
    \Bigr]_{0}^{1}.
    \]
    计算括号内：
    \[
    \left.\frac{s^4}{4}\right|_{0}^{1} = \frac{1}{4},\quad
    \left.-\,\frac{s^2}{2}\right|_{0}^{1} = -\,\frac{1}{2}.
    \]
    所以
    \[
    \int_{0}^{1} \bigl(s^3 - s\bigr)\,ds
    = \frac{1}{4} - \frac{1}{2} 
    = -\,\frac{1}{4},
    \quad
    a_{2} = -\,\frac{1}{6} \cdot \Bigl(-\,\frac{1}{4}\Bigr)
    = \frac{1}{24}.
    \]
\end{itemize}

综上可得三步隐式 Adams–Moulton 方法（AM3）为
\[
\boxed{
y_{n+1} 
= y_n 
+ h \Bigl(
  \frac{9}{24}\,f(x_{n+1},y_{n+1})
+ \frac{19}{24}\,f(x_{n},\,y_{n})
- \frac{5}{24}\,f(x_{n-1},\,y_{n-1})
+ \frac{1}{24}\,f(x_{n-2},\,y_{n-2})
\Bigr).
}
\]

注意到若 $f(x,y)$ 关于 $y$ 是线性的（例如 $f(x,y)=y - x^2 +1$），则上述公式隐式项
\[
\frac{9}{24}\,f(x_{n+1},\,y_{n+1})
\]
可以展开成 $\frac{9}{24}\bigl(y_{n+1} - x_{n+1}^2 +1\bigr)$，从而将 $y_{n+1}$ 的系数收集后可显式解出 $y_{n+1}$。

根据integral.m的代码生成结果如下

\begin{tabular}{|l|l|l|}
\hline
\textbf{步长 $h$} & \textbf{AB4 最大误差} & \textbf{AM3 最大误差} \\
\hline
$h = 0.1250$ & $4.1240 \times 10^{-4}$ & $4.3885 \times 10^{-5}$ \\
$h = 0.0625$ & $3.2025 \times 10^{-5}$ & $2.8674 \times 10^{-6}$ \\
$h = 0.0312$ & $2.2203 \times 10^{-6}$ & $1.8273 \times 10^{-7}$ \\
\hline
\end{tabular}


\begin{tabular}{|l|l|l|}
\hline
\textbf{估计收敛阶} & \textbf{AB4} & \textbf{AM3} \\
\hline
$h=0.1250\to 0.0625$ & $3.6868$ & $3.9359$ \\
$h=0.0625\to 0.0312$ & $3.8503$ & $3.9719$ \\
\hline
\end{tabular}

可见两者的收敛阶都在 $4$ 附近，说明两者都是四阶方法。
\end{problem}
\end{document}